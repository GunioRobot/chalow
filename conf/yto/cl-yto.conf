# -*- perl -*-
### ユーザ設定項目 ###

# --------------------------------------------------------------------
# 日記の名前
$changelog_name = "たつをの ChangeLog";

# --------------------------------------------------------------------
# ChangeLog を公開する URL (絶対 URL を強く推奨) - RSS に必要
# 例: $clog_url = "http://nais.to/~yto/clog/";
$clog_url = "http://nais.to/~yto/clog/"; # 必ず URL を設定して下さい

# --------------------------------------------------------------------
# インデックスページ (index.html) で最近何日分を表示するか
# (コマンドラインオプション "-n" でも指定できます)
$opt_topn = 4;

# --------------------------------------------------------------------
# 日ごとにページを作るか (0:NO, 1:YES) --- obsolete
#$day_page_mode = 1;

# --------------------------------------------------------------------
# 作成するページの単位 (0:月, 1:日, 2:アイテム)
$page_mode = 2;

# --------------------------------------------------------------------
# 自動文字列置換
$auto_replace = '
s!(<blockquote>)!</p>$1!g;
s!(</blockquote>)!$1<p>!g;
s!(chalow)(<|\s|[\x80-\xff]|$)!<a href="http://nais.to/~yto/tools/chalow/">$1</a>$2!g;
s!(ふむ\s*?Wiki)(\s|[\x80-\xff])!<a href="http://nais.to/hiki/">$1</a>$2!g;
s!(amazon)\s!<a href="http://www.amazon.co.jp/exec/obidos/redirect?tag=ytoshomepage-22&path=tg/browse/-/489986">$1</a> !g;
s!(satoru-t)!<a href="http://namazu.org/~satoru/">$1</a>!g;
s!(taku-ku)(\s)!<a href="http://www.tahoo.org/~taku/">$1</a>$2!g;
s!(daiti-m)(\s)!<a href="http://cl.aist-nara.ac.jp/~daiti-m/">$1</a>$2!g;
s!(kambara)(\s)!<a href="http://sappari.org/">$1</a>$2!gi;
s!(masayu-a)([^/])!<a href="http://chasen.aist-nara.ac.jp/~masayu-a/">$1</a>$2!g;
s|(Sサノ)|<a href="http://www.ss.iij4u.or.jp/~sassano/ja/log/">$1</a>|g;
s|(塚田)|<a href="http://mobiquitous.com/~tsuka/">$1</a>|g;
s|\$\$(.+?)\$\$|qq(<img src="./mimetex.cgi?$1" align=absmiddle>)|ge;
s!bk1(\s)!<a href="http://www.bk1.co.jp/cgi-bin/srch/srch_top.cgi?aid=p-137467927">bk1</a>$1!g;
s|naoya\s|<a href="http://naoya.dyndns.org/~naoya/mt/">naoya</a> |g;
s%(ついてる(！|!)+)%<a href="http://blog.zikokeihatu.com/">$1</a>%g;
s%(ツイてる(！|!)+)%<a href="http://blog.zikokeihatu.com/">$1</a>%g;
s|(tokuhirom)(\s)|<a href="http://www13.ocn.ne.jp/~tokuhiro/cl/">$1</a>$2|g;
s|(miyagawa)(\s)|<a href="http://blog.bulknews.net/mt/">$1</a>$2|g;
s|(\[N\])|<a href="http://netafull.net/">$1</a>|g;
s|(ContentEditableWiki)|<a href="http://nais.to/~yto/tools/contenteditablewiki/">$1</a>|g;
s|(TextAreaWiki)|<a href="http://nais.to/~yto/tools/textareawiki/">$1</a>|g;
s!\[RTBK\]!<a href="http://pt.afl.rakuten.co.jp/c/005cbacd.ec83e448/?url=http%3a%2f%2fwww.rakuten.co.jp%2frbooks%2f" target="_blank">[楽天]</a>!g;
';

# --------------------------------------------------------------------
# ファイルの最初に出てくる「<!-- ReplaceOnce -->」を置き換える文字列
# （自分のIDに変えて使って下さい）
$replace_once = << "__REPLACE_ONCE"
<script type="text/javascript"><!--
google_ad_client = "pub-9484365204996995";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="0673044179";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "0000ff";
google_color_url = "0000ff";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
__REPLACE_ONCE
    ;

# --------------------------------------------------------------------
# CSS ファイル
$css_file = "diary.css";
#$css_file = "clover/clover.css";

# --------------------------------------------------------------------
# 日付の後に曜日(Mon, Tue, ...)を表示するか (1:yes or 0:no)
$show_day_of_week = 1;

# --------------------------------------------------------------------
# 月ページで、日付を降順 (新しい日付が上) で表示するか (1:yes or 0:no)
$reverse_order_days = 1;

# --------------------------------------------------------------------
# アイテムヘッダーのフォーマットをどうするか
# (0:"* HOGE:", 1:"* HOGE", 2:"HOGE:",3:"HOGE")
$item_header_style = 1;

# --------------------------------------------------------------------
# 表示するとき引用記号 ('>' or '|') を消すか (1:YES, 0:NO)
$remove_quote_mark = 1;

# --------------------------------------------------------------------
# item header で h3 タグを使うか (1:YES, 0:NO) - tDiary との互換性のため
$use_h3_for_item_header = 0;

# --------------------------------------------------------------------
# item header の先頭の記号にアンカーをつけるか (1:YES, 0:NO)
$use_item_anchor = 1;

# --------------------------------------------------------------------
# item header の先頭の記号の指定
# 『日記のセクションの先頭(サブタイトルの行頭)に挿入される、リンク用の
# アンカー文字列を指定します。なお「<span class="panchor">_</span>」を
# 指定すると、テーマによっては自動的に画像アンカーがつくようになりま
# す。』(tDiary の skel/conf.rhtml より)
$item_header_mark = qq(<span class="sanchor">*</span>);

# --------------------------------------------------------------------
# RSS を出力するか (1:YES, 0:NO)
$output_rss = 1;

# --------------------------------------------------------------------
# 日記の説明 for RSS : 例: "日々のあれこれ。"
$changelog_description = "主にコンピュータ技術者向けの話題（プログラミング技術、ソフト紹介、サイト紹介、書籍紹介）を提供し続ける情報サイトです。";

# --------------------------------------------------------------------
# 他の年の同じ日付 (月日) へのリンクを張るか (1:YES, 0:NO)
$same_date_jump = 1;

# --------------------------------------------------------------------
# 日付一覧をカレンダー表示にするか (1:YES, 0:NO)
$calendar_style = 0;

# --------------------------------------------------------------------
# 検索用ファイル (cl.itemlist) を作るか (1:YES, 0:NO)
$output_itemlist = 1;

# --------------------------------------------------------------------
# 見出し一覧 (JavaScript ファイル) で出力する日数
$latest_titles_num = 10;

# --------------------------------------------------------------------
# カテゴリページを作るか (0:NO, 1:YES)
$output_cat_pages = 0;

# --------------------------------------------------------------------
# カテゴリページ中のエントリ数の上限
# ($output_cat_pages = 1 のときのみ有効)
$cat_page_entry_max = 20;

# --------------------------------------------------------------------
# カテゴリ別item表示のためのCGIを指定する（カテゴリ名は %%CAT%% で置き換え）
# ($output_cat_pages = 0 のときのみ有効)
$cat_page_cgi = "clsearch.cgi?cat=%%CAT%%";
#$cat_page_cgi = "";


######################################################################
## テンプレート

my $old_nikki = << "___OLD_NIKKI"
<a href="../nikki/">「たつをの ChangeLog」以前の日記</a><br>
2000 : <a href="../nikki/0001.html">01</a> <a href="../nikki/0002.html">02</a> <a href="../nikki/0003.html">03</a> 04 05 06 07 08 09 10 11 12 <br>
1999 : <a href="../nikki/9901.html">01</a> <a href="../nikki/9902.html">02</a> <a href="../nikki/9903.html">03</a> <a href="../nikki/9904.html">04</a> <a href="../nikki/9905.html">05</a> <a href="../nikki/9906.html">06</a> <a href="../nikki/9907.html">07</a> <a href="../nikki/9908.html">08</a> <a href="../nikki/9909.html">09</a> <a href="../nikki/9910.html">10</a> <a href="../nikki/9911.html">11</a> <a href="../nikki/9912.html">12</a> <br>
1998 : <a href="../nikki/9801.html">01</a> <a href="../nikki/9802.html">02</a> <a href="../nikki/9803.html">03</a> <a href="../nikki/9804.html">04</a> <a href="../nikki/9805.html">05</a> <a href="../nikki/9806.html">06</a> <a href="../nikki/9807.html">07</a> <a href="../nikki/9808.html">08</a> <a href="../nikki/9809.html">09</a> <a href="../nikki/9810.html">10</a> <a href="../nikki/9811.html">11</a> <a href="../nikki/9812.html">12</a> <br>
1997 : <a href="../nikki/9701.html">01</a> <a href="../nikki/9702.html">02</a> <a href="../nikki/9703.html">03</a> 04 <a href="../nikki/9705.html">05</a> <a href="../nikki/9706.html">06</a> <a href="../nikki/9707.html">07</a> <a href="../nikki/9708.html">08</a> <a href="../nikki/9709.html">09</a> <a href="../nikki/9710.html">10</a> <a href="../nikki/9711.html">11</a> <a href="../nikki/9712.html">12</a> <br>
1996 : <a href="../nikki/9601.html">01</a> <a href="../nikki/9602.html">02</a> <a href="../nikki/9603.html">03</a> <a href="../nikki/9604.html">04</a> <a href="../nikki/9605.html">05</a> <a href="../nikki/9606.html">06</a> <a href="../nikki/9607.html">07</a> <a href="../nikki/9608.html">08</a> <a href="../nikki/9609.html">09</a> <a href="../nikki/9610.html">10</a> <a href="../nikki/9611.html">11</a> <a href="../nikki/9612.html">12</a> <br>
1995 : 01 02 03 04 05 06 07 <a href="../nikki/9508.html">08</a> <a href="../nikki/9509.html">09</a> <a href="../nikki/9510.html">10</a> <a href="../nikki/9511.html">11</a> <a href="../nikki/9512.html">12</a>
___OLD_NIKKI
    ;

# (サイドメニュー、サイドバー)
my $side_menu = << "___SIDE_MENU"
<div class="funcbox">最終更新時刻<br><TMPL_VAR name=lastupdate></div>
<div class="funcbox"><a href="http://nais.to/~yto/clog/kuttukibbs.cgi?mode=latest">最近のツッコミ</a> / 
<a href="http://nais.to/~yto/clog/cl.rdf">RSS</a>
</div>
<div class="funcbox" title="検索キーワードは複数指定できます">
<FORM METHOD="GET" ACTION="clsearch.cgi" style="margin:0;padding:0">
ChangeLogを検索<br>
<INPUT TYPE="text" NAME="key" size="10">
<input type="checkbox" name="mode" value="1" checked>
<INPUT TYPE="submit" NAME=".submit" VALUE="ok">
</FORM>
</div>
<div class="funcbox">
<a href="clkeitai.cgi">携帯電話からアクセス！</a>
</div>
<p/>

<div class="stdbox">
<table>
<tr><td>カテゴリ</td></tr>
<tr><td><TMPL_VAR name=category_list></td></tr>
</table>
</div>
<p/>

<div class="stdbox">
<table>
<tr><td>最近の話題</td></tr>
<tr><td><TMPL_VAR name=latest_item_list></script></td></tr>
</table>
</div>
<p/>

<div class="stdbox">
<table>
<tr><td><a href="http://nais.to/~yto/doc/zb/">たつをの雑文</a> - 更新日時順</tr>
<tr><td><dl>
<script language="JavaScript" src="http://nais.to/~yto/var/zb.js"></script>
</dl></td></tr>
</table>
</div>
<p/>

<div class="stdbox">
<table>
<tr><td><a href="http://nais.to/~yto/tools/">小さなツールたち</a> - 更新日時順</a></tr>
<tr><td><dl>
<script language="JavaScript" src="http://nais.to/~yto/var/tools.js"></script>
</dl></td></tr>
</table>
</div>
<p/>
<div class="stdbox">
<script language="JavaScript" src="http://nais.to/~yto/var/hiki.js"></script>
</div>

<p/>
<div class="stdbox">
<table>
<tr><td><a href="http://nais.to/~yto/clog/2004-02-02.html#2004-02-02-4">くっつき「運動記録」</a></td></tr>
<tr><td><dl>
<script language="JavaScript" src="http://nais.to/~yto/var/undou.js"></script>
</dl></td></tr>
</table>
</div>
<p/>

<div class="funcbox" align="center">
<a href="http://nais.to/attic/kininarutana/">気になる棚<br/>
<img src="image/kininarutana.png" border="0">
</a>
</div>
<p/>

<div class="funcbox" align="center">
<a href="http://www.chatango.com/"><b>Chatango</b></a> : 
手軽なチャット。緑のときに↓をクリック！<br/>
<a href=http://yto.chatango.com/ target=_blank><img
border=0 src=http://yto.chatango.com/i></a>
</div>
<p/>

<div class="stdbox">
<table>
<tr><td>My Selection (楽天)</td></tr>
<tr><td>
<style>.rakuten img {float:left;margin-right:2pt;}</style>
<span class="rakuten" style="font-size: x-small;">
<script language="JavaScript" src="http://nais.to/~yto/var/rakuten.js"></script>
</span>
<div align="center">
<form style="margin: 0;" 
method=get action="http://pt.afl.rakuten.co.jp/c/00227a5c.2b649b5c/"><input type=hidden name=sv value=2><input type=hidden name=p value=0>
<input type=text size=10 name=sitem value=>
<input type=submit value=商品検索 name=submit><br>
<img src=https://image.rakuten.co.jp/com/img/logo/base/w080.gif width=80 height=36 border=0 alt=楽天市場>
</form></div>
</td></tr>
</table>
</div>

<p/>
<div class="funcbox">
<form action="http://bulkfeeds.net/app/search2" method="GET" style="margin:0;padding:0">
<a href="http://bulkfeeds.net/">Bulkfeeds</a>: RSS 検索<br>
<input size="10" type="text" name="q" />
<input type="hidden" name="ie" value="euc-jp" />
<input value="ok" type="submit" /><br />
Sort by <select name="sort"><option value="score">Score</opntion>
<option value="date" selected>Date</opntion></select>
</form>
</div>

<p/>
<div class="stdbox">
<table>
<!--
<tr><td>BlogPeople</td></tr>
<tr><td>
<script language="javascript" type="text/javascript" src="http://www.blogpeople.net/display/usr/0f0d47555b5a4103.js"></script>
・<a href="javascript:void(bloppop=window.open('http://www.blogpeople.net/addlink.jsp?u=http%3A%2F%2Fnais.to%2F%7Eyto%2Fclog%2F','blop','scrollbars=no,width=475,height=350,left=75,top=175,status=yes,resizable=yes'));">私を登録 by BlogPeople</a>
</td></tr>
-->
<tr><td>Birthday Blog</td></tr>
<tr><td>
<script language="javascript" type="text/javascript" 
src="http://www.blogpeople.net/display/usr/bb_euc.js"></script>
</td></tr>
</table>
</div>
<p/>

<div class="stdbox">
<table>
<tr><td>はてな</td></tr>
<tr><td>
<a href="http://a.hatena.ne.jp/append?http://nais.to/~yto/clog/">はてなアンテナに追加</a>
<br>
<a href="http://a.hatena.ne.jp/yto/">たつをアンテナ</a>
</td></tr>
</table>
</div>
<p/>

<div class="stdbox">
<table>
<tr><td>過去ログ</td></tr>
<tr><td style="font-size:11px;text-align:center">
<TMPL_VAR name=month_page_list>
$old_nikki
</td></tr>
</table>
</div>
<p/>



___SIDE_MENU
    ;


my $side_menu_r = << "___SIDE_MENU"
<!--
<div class="funcbox" align="center">
<a href="http://nais.to/~yto/commu/camera.html" target="_blank"><img 
src="http://nais.to/~yto/commu/camera/licam.jpg" width="120" height="90"
 alt="Webカメラとチャット"></a>
</div>
-->

___SIDE_MENU
    ;
#<p/>
#<div class="stdbox">
#<table>
#<tr><td>MyClip</td></tr>
#<tr><td>
#<script language="javascript" type="text/javascript" src="http://clipdata.myblog.jp/list/js?code=c19b336a11f673767d2ffcfc31708a46" charset="EUC-JP"></script>
#</td></tr>
#</table>
#</div>



# インデックスページのテンプレート
$index_page_template = << "___INDEX_PAGE_TEMPLATE"
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=EUC-JP">
<TMPL_IF name=css_file>
<link rel=stylesheet href="<TMPL_VAR name=css_file>" media=all>
</TMPL_IF>
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://nais.to/~yto/clog/cl.rdf">
<title><TMPL_VAR name=cl_name></title>
</head>
<body>
<p class="adminmenu"><a href="http://nais.to/">トップ</a> &gt; <a href="http://nais.to/~yto/">たつをのホームページ</a> &gt; <TMPL_VAR name=cl_name></p>
<!--<h1><img src="image/ytocl-logo.png"></h1>-->

<h1><a href="./"><TMPL_VAR name=cl_name></a>
 <img style="margin:0" src="image/mimitako1.png"></h1>

<div id="content">
<p style="font-size: small;">$changelog_description</p>
<p>
<iframe src="http://asamasi.net/asamasel/id/000/000/ban.html" width="468" height="60" scrolling="no" marginheight="0" marginwidth="0" vspace="0" hspace="0" frameborder="0"></iframe>
</p>
<p>最近 <TMPL_VAR name=ndays> 日分 / <a href="<TMPL_VAR name=ym>.html">今月の一覧</a>
 / <a href="http://nais.to/attic/kininarutana/">気になる棚</a>
<p/>
<TMPL_LOOP name=entries> 
<TMPL_VAR name=content> 
</TMPL_LOOP>
</div>

<div id="links">$side_menu</div>
<div id="footer">
<div style="text-align: center">
ご意見・ご感想は<a href="/~yto/msgsd/msgsd.cgi">こちら</a>からどうぞ。
</p>
<p>このページへのアクセス数 [ <script language="JavaScript" src="../kuttuki-counter-yesterday.cgi?clog-yesterday"></script> | total: <script language="JavaScript" src="../kuttuki-counter.cgi?clog"></script> ]
<br>(since 2003-09-07 10 a.m.)</p>
<p><A HREF="http://readmej.com/" target="_blank"><IMG SRC="http://readmej.com/readme.cgi?yto\@nais.to" WIDTH=76 HEIGHT=19 BORDER=1></A>
<a href="http://feedmeter.net/detail.php?r=http%3A%2F%2Fnais.to%2F%7Eyto%2Fclog%2Fcl.rdf" target="_feedmeter"><img src="http://feedmeter.net/image.php?r=http%3A%2F%2Fnais.to%2F%7Eyto%2Fclog%2Fcl.rdf" border=0 alt="RSS feed meter for http://nais.to/~yto/clog/"></a>
</p>
</div>
<p class="adminmenu"><a href="http://nais.to/">トップ</a> &gt; <a href="http://nais.to/~yto/">たつをのホームページ</a> &gt; <TMPL_VAR name=cl_name></p>
<div style="text-align:right"><TMPL_VAR name=signature></div>
</div>
</body></html>
___INDEX_PAGE_TEMPLATE
    ;

# 月ページのテンプレート
$month_page_template = << "___MONTH_PAGE_TEMPLATE"
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=EUC-JP">
<TMPL_IF name=css_file>
<link rel=stylesheet href="<TMPL_VAR name=css_file>" media=all>
</TMPL_IF>
<link rel="alternate" type="application/rss+xml" title="RSS" href="cl.rdf">
<title><TMPL_VAR name=cl_name> / <TMPL_VAR name=ym></title>
</head>
<body>
<div style="width:750px">
<p class="adminmenu">
<TMPL_IF name=back><a href="<TMPL_VAR name=back>.html">前の月</a> / </TMPL_IF>
<TMPL_IF name=next><a href="<TMPL_VAR name=next>.html">次の月</a> / </TMPL_IF>
<a href="index.html">最新</a></p>
<h1><a href="./"><TMPL_VAR name=cl_name></a> / <TMPL_VAR name=ym></h1>
<p class="calendar"><TMPL_VAR name=day_list></p>
<TMPL_LOOP name=entries><TMPL_VAR name=content></TMPL_LOOP>
<p class="calendar"><TMPL_VAR name=month_page_list></p>
<p class="calendar">$old_nikki</p>
<p><A HREF="http://readmej.com/" target="_blank"><IMG SRC="http://readmej.com/readme.cgi?yto\@nais.to" WIDTH=76 HEIGHT=19 BORDER=1></A></p>
<p>最終更新時間: <TMPL_VAR name=lastupdate></p>
<TMPL_VAR name=signature>
</div>
</body></html>
___MONTH_PAGE_TEMPLATE
    ;

# 日ページのテンプレート
$day_page_template = << "___DAY_PAGE_TEMPLATE"
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=EUC-JP">
<TMPL_IF name=css_file>
<link rel=stylesheet href="<TMPL_VAR name=css_file>" media=all>
</TMPL_IF>
<link rel="alternate" type="application/rss+xml" title="RSS" href="cl.rdf">
<title><TMPL_VAR name=cl_name> / <TMPL_VAR name=ymd></title>
</head>
<body>
<div style="width:750px">
<p class="adminmenu">
<TMPL_IF name=back><a href="<TMPL_VAR name=back>.html">前の日</a> / </TMPL_IF>
<TMPL_IF name=next><a href="<TMPL_VAR name=next>.html">次の日</a> / </TMPL_IF>
<a href="index.html">最新</a> / <a href="<TMPL_VAR name=ym>.html"><TMPL_VAR name=ym></a></p>
<h1><a href="./"><TMPL_VAR name=cl_name></a> / <TMPL_VAR name=ymd></h1>
<p class="calendar"><TMPL_VAR name=day_list></p>
<TMPL_VAR name=content> 
<p class="calendar"><TMPL_VAR name=month_page_list></p>
<p class="calendar">$old_nikki</p>
<p><A HREF="http://readmej.com/" target="_blank"><IMG SRC="http://readmej.com/readme.cgi?yto\@nais.to" WIDTH=76 HEIGHT=19 BORDER=1></A></p>
<p>最終更新時間: <TMPL_VAR name=lastupdate></p>
<TMPL_VAR name=signature>
</div>
</body></html>
___DAY_PAGE_TEMPLATE
    ;

# アイテムページのテンプレート
my $navibar = << "BAR"
<table width="750" cellpadding=0 cellspacing=0>
<tr>
<td align="left">
<TMPL_IF name=back><a href="<TMPL_VAR name=back>.html">前</a> / </TMPL_IF>
<TMPL_IF name=next><a href="<TMPL_VAR name=next>.html">次</a> / </TMPL_IF>
<a href="index.html"><TMPL_VAR name=cl_name></a>
</td>
<td align="right">
<FORM METHOD="GET" ACTION="clsearch.cgi" style="margin:0;padding:0" target="_blank">
<INPUT TYPE="text" NAME="key" size="15">
<input type="checkbox" name="mode" value="1" checked>
<INPUT TYPE="submit" VALUE="検索">
<a href="http://nais.to/~yto/clog/rand.cgi">RandomJump</a>
</FORM>
</td>
</tr>
</table>
BAR
    ;
$item_page_template = << "___PAGE_TEMPLATE"
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=EUC-JP">
<TMPL_IF name=css_file>
<link rel=stylesheet href="<TMPL_VAR name=css_file>" media=all>
</TMPL_IF>
<link rel="alternate" type="application/rss+xml" title="RSS" href="cl.rdf">
<title><TMPL_VAR name=header_text></title>
</head><body>
<div style="width:750px">

$navibar

<h1><TMPL_VAR name=header></h1>

<div style="text-align:right">
<script type="text/javascript"><!--
google_ad_client = "pub-9484365204996995";
google_alternate_ad_url = "http://asamasi.net/asamasel/id/000/000/ban.html";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="0673044179";
google_color_border = "ffffff";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<div class="day">

<div class="body">
<!-- start:<TMPL_VAR name=ymdi> -->
<p class="footer"><span style="background-color:#fff8ff">
<a href="<TMPL_VAR name=ymd>.html#<TMPL_VAR name=ymdi>"><TMPL_VAR name=ymd></a>
 / <a href="<TMPL_VAR name=ymdi>.html"><TMPL_VAR name=header_text></a>
<TMPL_IF name=cat><TMPL_VAR name=cat></TMPL_IF></span>
</p>
<div class="section">
<p><TMPL_VAR name=content></p>
<TMPL_IF name=referrer>
 <div class="referer"><span>Referrer (Inside): 
 <TMPL_VAR name=referrer></span></div>
</TMPL_IF>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<center>
<iframe src="http://asamasi.net/asamasel/id/000/000/bigban.html" width="728" height="90" scrolling="no" marginheight="0" marginwidth="0" vspace="0" hspace="0" frameborder="0"></iframe>
</center>
<div class="comment">
<div class="caption">[ <a href="<TMPL_VAR name=url>">固定リンク</a> | 
<a href='./kuttukibbs.cgi?id=<TMPL_VAR name=ymdi>'>コメント</a> | 
<a href="tb/tb.cgi?__mode=list&tb_id=<TMPL_VAR name=id>">トラックバック
(<script language="JavaScript" src="tb/tb_data/<TMPL_VAR name=id>.js">
</script>)</a> ]</div>
<script language="JavaScript" type="text/javascript" 
 src="kblog/<TMPL_VAR name=ymdi>.js"></script>
</div>

<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="${clog_url}<TMPL_VAR name=ymdi>.html"
  trackback:ping="http://nais.to/~yto/clog/tb/tb.cgi/<TMPL_VAR name=id>"
  dc:title="<TMPL_VAR name=header_text>"
  dc:identifier="${clog_url}<TMPL_VAR name=ymdi>.html" />
</rdf:RDF>
</div></div>

$navibar

<p><A HREF="http://readmej.com/" target="_blank"><IMG SRC="http://readmej.com/readme.cgi?yto\@nais.to" WIDTH=76 HEIGHT=19 BORDER=1></A></p>
<!--<p>最終更新時間: <TMPL_VAR name=lastupdate></p>-->
<TMPL_VAR name=signature>
</div>
</div></body></html>
___PAGE_TEMPLATE
    ;


# カテゴリページのテンプレート
$cat_page_template = << "TMPL"
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=EUC-JP">
<TMPL_IF name=css_file>
<link rel=stylesheet href="<TMPL_VAR name=css_file>" media=all>
</TMPL_IF>
<link rel="alternate" type="application/rss+xml" title="RSS" href="cl.rdf">
<title><TMPL_VAR name=cat_name> / <TMPL_VAR name=cl_name></title>
</head>
<body>

<p class="adminmenu"><a href="index.html">ChangeLog 最新ページ</a>
<TMPL_IF name=page_list>
 / <a href="<TMPL_VAR name=first_page>">カテゴリ最新ページ</a> / 
<TMPL_IF name=back><a href="<TMPL_VAR name=back>">前ページ</a></TMPL_IF>
<TMPL_VAR name=page_list>
<TMPL_IF name=next><a href="<TMPL_VAR name=next>">次ページ</a></TMPL_IF>
</TMPL_IF>
</p>

<h1>カテゴリ[<TMPL_VAR name=cat_name>] - 
 <a href="./"><TMPL_VAR name=cl_name></a></h1>
<p>
<div>
<TMPL_LOOP name=entries>
<div class="day"><h2><span class="date"><TMPL_VAR name=eh></span></h2>
<div class="body"><TMPL_VAR name=cont>
<TMPL_IF NAME="__first__">
</TMPL_IF>
</div></div>
</TMPL_LOOP>

<p class="adminmenu"><a href="index.html">ChangeLog 最新ページ</a>
<TMPL_IF name=page_list>
 / <a href="<TMPL_VAR name=first_page>">カテゴリ最新ページ</a> / 
<TMPL_IF name=back><a href="<TMPL_VAR name=back>">前ページ</a></TMPL_IF>
<TMPL_VAR name=page_list>
<TMPL_IF name=next><a href="<TMPL_VAR name=next>">次ページ</a></TMPL_IF>
</TMPL_IF>
</p>
<p>最終更新時間: <TMPL_VAR name=lastupdate></p>
<p><A HREF="http://readmej.com/" target="_blank"><IMG SRC="http://readmej.com/readme.cgi?yto\@nais.to" WIDTH=76 HEIGHT=19 BORDER=1></A></p>
<TMPL_VAR name=signature>
</div></body></html>
TMPL
    ;

# item のテンプレート
$item_template = << "EACHITEM"
<!-- start:<TMPL_VAR name=ymdi> -->
<div class="section">
<p><TMPL_VAR name=header><TMPL_VAR name=cat>
<TMPL_VAR name=content></p>
<TMPL_IF name=referrer>
<div class="referer"><span>Referrer (Inside): 
<TMPL_VAR name=referrer></span></div>
</TMPL_IF>
<!--<TMPL_VAR name=id>-->
<div class="referer"><span>
[ <a href='<TMPL_VAR name=ymdi>.html'>固定リンク</a> | 
<a href='./kuttukibbs.cgi?id=<TMPL_VAR name=ymdi>'>コメント</a> | 
<a href="tb/tb.cgi?__mode=list&tb_id=<TMPL_VAR name=id>">トラックバック</a> ]
</span></div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- ReplaceOnce -->
EACHITEM
    ;

# entry (date) のテンプレート
$entry_template = << "DAYENTRY"
<div class="day">
<h2><span class="date"><TMPL_VAR name=header></span></h2>

<div class="body">

<TMPL_IF name=message_top><TMPL_VAR name=message_top></TMPL_IF>

<TMPL_IF name=same_date>
<div class="calendar"><TMPL_VAR name=same_date></div>
</TMPL_IF>

<TMPL_VAR name=content>

<TMPL_IF name=referrer><div class="referer"><span>Referrer (Inside): 
<TMPL_VAR name=referrer></span></div></TMPL_IF>

<TMPL_IF name=message_bottom><TMPL_VAR name=message_bottom></TMPL_IF>

<div class="comment">
<div class="caption">[ 
<a href='./kuttukibbs.cgi?id=<TMPL_VAR name=ymd>'>コメント</a> | 
<a href="tb/tb.cgi?__mode=list&tb_id=<TMPL_VAR name=id>">トラックバック
(<script language="JavaScript" src="tb/tb_data/<TMPL_VAR name=id>.js">
</script>)</a> ]</div>
<script language="JavaScript" type="text/javascript" 
 src="kblog/<TMPL_VAR name=ymd>.js"></script>
</div>

<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="${clog_url}<TMPL_VAR name=ymd>.html"
  trackback:ping="http://nais.to/~yto/clog/tb/tb.cgi/<TMPL_VAR name=id>"
  dc:title="$changelog_name <TMPL_VAR name=ymd>"
  dc:identifier="${clog_url}<TMPL_VAR name=ymd>.html" />
</rdf:RDF>

</div>
</div>
DAYENTRY
    ;



######################################################################
## プラグイン

### コメントアウト
# usage: {{com('これは HTML 変換時に削られます')}}
sub com { }

### clsearch キーワード検索 URL 作成
# usage: {{clsearch('海老名 映画館')}}
# usage: {{clsearch('海老名 映画館', 1)}}
sub clsearch {
    my ($k, $mode) = @_;
    my $o = $k;
    $k =~ s/([^0-9a-z_ ])/'%'.unpack('H2', $1)/gei;
    $k =~ s/\s/+/g;
    $mode = "&mode=$mode" if (defined $mode);
    return qq(<a href="clsearch.cgi?key=$k$mode">$o</a>);
}

### google キーワード検索 URL 作成
# usage: {{google_search('海老名 映画館')}}
sub google_search {
    my ($k) = @_;
    my $o = $k;
    $k =~ s/([^0-9a-z_ ])/'%'.unpack('H2', $1)/gei;
    $k =~ s/\s/+/g;
    my $c = "ie=EUC-JP&oe=EUC-JP&";
    return qq(<a href="http://www.google.co.jp/search?${c}q=$k">$o</a>);
}

### Bulkfeeds キーワード検索
# usage: {{bulkfeeds('海老名 映画')}}
sub bulkfeeds {
    my ($k) = @_;
    my $o = $k;
    $k = Jcode->new($k)->utf8;
    $k =~ s/([^0-9a-z_ ])/'%'.unpack('H2', $1)/gei;
    $k =~ s/\s/+/g;
    return qq(<a href="http://bulkfeeds.net/app/search2?q=$k">$o</a>);
}

### Wiki へのリンクの作成
# usage: {{wiki_link('WIKINAME')}}
sub wiki_link {
    my ($k, $o) = @_;
    my $prefix = "http://nais.to/hiki/hiki.cgi?";
    $o = $k if (not defined $o);
    $k =~ s/([^0-9a-z_ ])/'%'.unpack('H2', $1)/gei;
    $k =~ s/\s/+/g;
    return qq(<a href="$prefix$k">$o</a>);
}

### amazon リンクの作成
# usage: {{amazon('ASIN', 'STR')}}
sub amazon {
    my ($asin, $str) = @_;
    my $prefix = "http://www.amazon.co.jp/exec/obidos/ASIN";
#    my $suffix = "";
    my $suffix = "ytoshomepage-22/ref=nosim"; # アソシID使用時
    $str =~ s/(\s|^)(\S+\.(jpg|jpeg|png|gif))/$1<img src="$2">/gi;
    $str =~ s/$/<br>/gm;
    $str =~ s/<br>\Z//m;
    return qq(<a href="$prefix/$asin/$suffix">$str</a>);
}

### bk1 リンクの作成 - ISBN検索
# usage: {{bk1('ISBN')}}
sub bk1 {
    my ($isbn) = @_;
    my $aid = "p-137467927";
    return qq(<a href="http://breeder.bk1.jp/rd/$isbn/$aid/noentry"
	      target="_blank">[bk1]</a>);
}

sub az {amazon(@_)}
sub azs {amazon_search(@_)}
sub bf {bulkfeeds(@_)}
sub cls {clsearch(@_)}
sub gs {google_search(@_)}

### amazon サーチ結果リンクの作成
# usage: {{amazon_search('STR' [,'MODE'])}}
sub amazon_search {
    my ($str, $mode) = @_;
    my $k = Jcode->new($str)->utf8;
    $k =~ s/([^0-9a-z_ ])/'%'.unpack('H2', $1)/gei;
    $k =~ s/\s/+/g;
    my $aid = "ytoshomepage-22";
    $mode = "blended" if not defined $mode;
    return '<a href="http://www.amazon.co.jp/exec/obidos/external-search'.
        "?tag=$aid&keyword=$k&mode=$mode\">$str</a>";
}

### 普通の amazon アソシエイトリンクの作成
# usage: {{amazon_link('ASIN', 'ID', 'STR')}}
sub amazon_link {
    my ($asin, $id, $str) = @_;
    my $prefix = "http://www.amazon.co.jp/exec/obidos/ASIN";
    $str =~ s/(\s|^)(\S+\.(jpg|jpeg|png|gif))/$1<img src="$2">/gi;
    $str =~ s/$/<br>/gm;
    $str =~ s/<br>\Z//m;
    return qq(<a href="$prefix/$asin/$id/ref=nosim">$str</a>);
}

### 後ろめたい amazon アソシエイトリンクの作成
# ref. <http://nais.to/~yto/clog/2003-11-06.html#2003-11-06-2>
# usage: {{qualmish_amazon_link('ASIN', 'ID', 'STR')}}
sub qualmish_amazon_link {
    my ($asin, $id, $str) = @_;
    my $prefix = "http://www.amazon.co.jp/exec/obidos/ASIN";
    $str =~ s/(\s|^)(\S+\.(jpg|jpeg|png|gif))/$1<img src="$2">/gi;
    $str =~ s/$/<br>/gm;
    $str =~ s/<br>\Z//m;
    return qq(<a href="$prefix/$asin/$id/ref=nosim" 
	      onMouseOver="window.status='$prefix/$asin'; return true;"
	      onMouseOut="window.status=''; return true;">$str</a>);
}

### URL を短く表示
# usage: {{shorten_url('http://example.com/abc/def/00101033/
# 0123456/aaaaaaaaaaaa/aaaaaaaaaaaa/index.html')}}
sub shorten_url {
    my ($url, $max) = @_;
    $max = 60 if not defined $max;
    $url =~ s/\s+//gsm;
    my $urlstr = $url;
    $urlstr =~ s/^(.{$max}).+$/$1 .../;
    return qq(<a href="$url">$urlstr</a>);
}

### カテゴリページへのリンク
# usage: {{cat('プログラミング')}}
sub cat {
    my ($cn) = @_;
    my $url = get_category_filename($cn);
    return qq(<a href="$url">$cn</a>);
}
